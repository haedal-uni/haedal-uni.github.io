<!DOCTYPE html><html lang="ko" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Ngrinder" /><meta property="og:locale" content="ko" /><meta name="description" content="nGrinder nGrinder는 성능 테스트를 위한 오픈 소스 플랫폼으로, Controller와 에이전트(Agent)로 구성된다." /><meta property="og:description" content="nGrinder nGrinder는 성능 테스트를 위한 오픈 소스 플랫폼으로, Controller와 에이전트(Agent)로 구성된다." /><link rel="canonical" href="https://haedal-uni.github.io//posts/nGrinder/" /><meta property="og:url" content="https://haedal-uni.github.io//posts/nGrinder/" /><meta property="og:site_name" content="Dal Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-03-21T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Ngrinder" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-31T02:08:32+09:00","datePublished":"2024-03-21T00:00:00+09:00","description":"nGrinder nGrinder는 성능 테스트를 위한 오픈 소스 플랫폼으로, Controller와 에이전트(Agent)로 구성된다.","headline":"Ngrinder","mainEntityOfPage":{"@type":"WebPage","@id":"https://haedal-uni.github.io//posts/nGrinder/"},"url":"https://haedal-uni.github.io//posts/nGrinder/"}</script><title>Ngrinder | Dal Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dal Blog"><meta name="application-name" content="Dal Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/cotes2020/chirpy-images/main/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dal Blog</a></div><div class="site-subtitle font-italic">한 걸음씩</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/haedal-uni" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Ngrinder</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Ngrinder</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1710946800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 21, 2024 </em> </span> <span> Updated <em class="" data-ts="1711818512" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 31, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/haedal-uni">haedal-uni</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4248 words"> <em>23 min</em> read</span></div></div></div><div class="post-content"><h1 id="ngrinder">nGrinder</h1><p>nGrinder는 성능 테스트를 위한 오픈 소스 플랫폼으로, Controller와 에이전트(Agent)로 구성된다.</p><p><br /></p><ul><li>컨트롤러 (Controller)</ul><p>nGrinder 성능 테스트를 관리하고 조정하는 중앙 집중형 서버다.</p><p>사용자는 웹 인터페이스를 통해 컨트롤러에 접속하여 테스트를 설정하고 실행할 수 있다.</p><p>컨트롤러는 테스트를 위해 Agent들을 관리하고, 테스트 결과를 수집하여 보고서를 생성한다.</p><p><br /><br /></p><ul><li>에이전트 (Agent)</ul><p>Controller에서 지시를 받아 성능 테스트를 수행하는 노드다.</p><p>여러 대의 Agent가 동시에 여러 서버에 분산되어 실행될 수 있다.</p><p>Agent는 실제 테스트 대상 시스템에 부하를 가해 성능을 측정하고, 이러한 결과를 Controller에 보고한다.</p><p><br /><br /></p><p>먼저 Controller를 설정하고 실행하여 웹 인터페이스를 통해 성능 테스트를 관리한다.</p><p>그런 다음, 테스트를 실행하기 위해 하나 이상의 에이전트를 준비하고 컨트롤러에 연결한다.</p><p>Controller에서 성능 테스트를 설정하고 실행하면, 에이전트들이 테스트를 수행하고 결과를 컨트롤러에 제공한다.</p><p><br /><br /><br /><br /></p><h2 id="설치-3가지-방법-중-1개-선택"><span class="mr-2">설치 (3가지 방법 중 1개 선택)</span><a href="#설치-3가지-방법-중-1개-선택" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="1-war-파일-다운"><span class="mr-2">1. war 파일 다운</span><a href="#1-war-파일-다운" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/naver/ngrinder/releases">설치 링크</a></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/bc9a8679-91dd-409a-af2a-2f6a4d132d62" alt="image" width="60%" data-proofer-ignore></p><p>ngrinder-controller-3.5.9.war 다운</p><p><br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ java -jar ngrinder-controller-3.5.9-p1.war --port=8300
</pre></table></code></div></div><p>Tomcat과 충돌하지 않는 포트 번호를 선택하여 사용했다.(충돌하지 않는 포트번호면 어떠한 것도 상관없음)</p><p><br /><br /><br /><br /></p><h3 id="2-docker"><span class="mr-2">2. Docker</span><a href="#2-docker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Controller 설치 및 실행</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ docker pull ngrinder/controller
$ docker run -d -v ~/ngrinder-controller:/opt/ngrinder-controller --name controller -p 80:80 -p 16001:16001 -p 12000-12009:12000-12009 ngrinder/controller
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">--name controller</code> : 컨테이너의 이름을 controller로 지정</p><li><p><code class="language-plaintext highlighter-rouge">-p 80:80</code> : 호스트의 80번 포트와 컨테이너의 80번 포트를 연결</p><li><p><code class="language-plaintext highlighter-rouge">-p 16001:16001</code> : 호스트의 16001번 포트와 컨테이너의 16001번 포트를 연결</p><li><p><code class="language-plaintext highlighter-rouge">-p 12000-12009:12000-12009</code> : 호스트의 12000부터 12009까지의 포트와 컨테이너의 동일한 범위의 포트를 연결</p><p>호스트의 8081번 포트를 컨테이너의 80번 포트로 사용하고 싶다면 -p 8081:80 으로 수정할 수 있디.</p></ul><p><br /></p><p>Agent 설치 및 실행</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ docker pull ngrinder/agent
$ docker run -d --name agent --link controller:controller ngrinder/agent
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">--name agent</code> : 컨테이너의 이름을 agent로 지정</p><li><p><code class="language-plaintext highlighter-rouge">--link controller:controller</code> : 다른 컨테이너인 controller와 agent를 연결</p><li><p><code class="language-plaintext highlighter-rouge">ngrinder/agent</code>: 이 컨테이너의 이미지로 ngrinder/agent를 사용</p></ul><p><br /></p><p>참고로 로컬에서 간단하게 테스트 하는 것이 아니라면 controller 와 agent 는 물리적으로 다른 서버에 두는 것이 좋다.</p><p>성능이 나오지 않아 원하는 만큼의 부하를 줄 수 가 없기 때문이다.</p><p>controller 와 agent 중 agent 서버의 성능이 더 중요하다.</p><p><br /><br /><br /></p><h3 id="3-docker-compose"><span class="mr-2">3. Docker Compose</span><a href="#3-docker-compose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-yml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.9'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">controller</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ngrinder/controller</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">ports</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">16001:16001"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">12000-12009:12000-12009"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./ngrinder-controller:/opt/ngrinder-controller</span>
  <span class="na">agent</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ngrinder/agent</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">controller</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">version: '3.9'</code> : Docker Compose 파일의 버전</p><p><code class="language-plaintext highlighter-rouge">restart: always</code> : 컨테이너가 종료되었을 때 자동으로 다시 시작하도록 지정</p><p><br /><br /></p><p><code class="language-plaintext highlighter-rouge">docker-compose.yml</code> 파일 실행</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ docker-compose up
</pre></table></code></div></div><p>만약 docker-com.yml과 같이 파일 명이 다를 경우 <code class="language-plaintext highlighter-rouge">docker-compose -f docker-com.yml up</code></p><p><br /><br /><br /></p><h2 id="사이트-확인"><span class="mr-2">사이트 확인</span><a href="#사이트-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Controller를 실행한 포트 번호로 브라우저 주소창에 <code class="language-plaintext highlighter-rouge">http://localhost:[포트번호]/login</code>을 입력하면</p><p>아래와 같은 화면을 확인할 수 있다.</p><p>ex) <code class="language-plaintext highlighter-rouge">http://localhost:80/login</code></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/d4c1856c-2d63-4205-a882-d2f96ce96282" alt="image" width="60%" data-proofer-ignore></p><p>초기 아이디와 패스워드는 모두 admin</p><p><br /><br /></p><p>메인 화면에서 오른쪽 상단 admin → Agent Management에 Agent 서버가 Controller에 정상적으로 적용되었는지 확인한다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/f32aac35-1b9c-43a6-b5f1-0af312af4b53" alt="image" data-proofer-ignore></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/5cfb3c8a-5ec5-4563-ac6f-b4a26ace2ff1" alt="image" data-proofer-ignore></p><p><br /><br /><br /></p><h2 id="api-호출-테스트"><span class="mr-2">API 호출 테스트</span><a href="#api-호출-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>API 호출을 테스트하기 위해서는 Script를 작성해야한다. 어떤 REST API로 요청을 보낼 것인지 설정해준다.</p><p>정상적으로 Agent가 동작중이라면 화면 상단에 위치한 탭에서 Script를 클릭하여 스크립트 화면으로 이동한 뒤,</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/27839b3b-3641-4486-a876-955bdb6ec787" alt="image" width="60%" data-proofer-ignore></p><p>테스트를 위해 <code class="language-plaintext highlighter-rouge">+ Create</code> 버튼을 누르고, Create a script를 선택한다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/fc3597e0-f445-463a-ba46-d2fd46b23ba7" alt="image" width="60%" data-proofer-ignore></p><p><br /><br /><br /></p><p>Script Name : 아무거나 작성</p><p>여기서 주의할 점은 URL에 ‘localhost, 127.0.0.1’로는 테스트가 불가능하다.</p><p><code class="language-plaintext highlighter-rouge">http://12.34.45.56:8080</code> 과 같이 <code class="language-plaintext highlighter-rouge">12.34.45.56</code> 를 본인 ip 주소를 작성하면 된다.</p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/66ba5b30-a6be-4852-bf63-77b4637f987b" alt="image" data-proofer-ignore></p><p>스크립트 생성 후, 우측 상단의 ‘Validate’ 버튼을 누르면 스크립트가 정상적으로 동작하는 지 검증할 수 있다.</p><p><br /><br /></p><p>상단의 Performance Test를 눌러서 실제 성능테스트를 진행한다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/e333eae5-8f0e-4874-b18e-0c39630af1a2" alt="image" data-proofer-ignore></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/198ff3d9-bc21-4a1e-a00f-2aacb23c2835" alt="image" data-proofer-ignore></p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/5c6c3fbe-d23d-41f1-8e6d-1f3e3bceb0fe" alt="image" data-proofer-ignore></p><ul><li><p>Agent: 방금 생성한 한 개의 script가 있기 때문에 1 입력</p><li><p>Vuser per agent: 테스트할 사용자 수 입력</p><li><p>Duration: 테스트할 시간을 지정한다.</p><li><p>Save and Start: 오른쪽 위 파란 버튼 클릭 후 실행</p></ul><p><br /><br /> <br /><br /></p><h3 id="테스트-결과-확인하기"><span class="mr-2">테스트 결과 확인하기</span><a href="#테스트-결과-확인하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Total Vusers (Virtual Users): 테스트에서 사용된 가상 사용자의 총 수</p><p>Agent: 테스트를 수행하는 데 사용된 ngrinder 에이전트의 수</p><p>Processes: 테스트 동안 실행된 프로세스의 수</p><p>Threads: 테스트 동안 사용된 스레드의 수</p><p>Sample Ignore: 무시된 샘플의 수</p><p>TPS (Transactions per Second): 초당 처리되는 트랜잭션의 수</p><p>Peak TPS (Peak Transactions per Second): 테스트 중 최고로 높았던 TPS 값</p><p>Mean Test Time: 평균 테스트 시간</p><p>Executed Tests: 실행된 테스트 케이스의 총 수</p><p>Successful Tests: 성공적으로 완료된 테스트 케이스의 수</p><p>Errors: 발생한 오류의 수</p><p><br /><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/fa6b3f38-4e55-49b3-81f0-4c2ff43d94ab" alt="image" data-proofer-ignore></p><ul><li>Total Vusers 99 → 99명의 가상 사용자가 사용<li>Agent 1 → 1개의 에이전트가 사용<li>Processes Threads 3 / 33 → 총 33개의 스레드 중에 3개의 스레드가 사용<li>Sample Ignore 0 → 0개의 샘플이 무시<li>TPS 102.2 → 평균 102.2개의 트랜잭션이 처리<li>Peak TPS 179 → 179개의 트랜잭션을 초당 가장 많이 처리<li>Mean Test Time 998.92 ms → 평균적으로 998.92밀리초가 소요<li>Executed Tests 5,449 → 총 5,449개의 테스트 케이스가 실행<li>Successful Tests 5,449 → 5,449개의 테스트 케이스가 성공적으로 완료<li>Errors 0 → 오류가 발생하지 않음</ul><p><br /><br /><br /><br /></p><hr /><h3 id="로그인-후-test"><span class="mr-2">로그인 후 test</span><a href="#로그인-후-test" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>주된 api는 대부분 로그인 한 후 token을 header에 담아서 진행되기 때문에 로그인 인증 정보를 제공해야했다.</p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/15757f7f-96b7-4fc1-a6fd-be0430041b61" alt="image" width="60%" data-proofer-ignore></p><p>위와 같이 header와 param을 입력해도 되고 아래 주석으로 작성한 것과 같이 직접 넣을 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">GrinderRunner</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestRunner</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">GTest</span> <span class="n">test</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HTTPRequest</span> <span class="n">request</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Cookie</span><span class="o">&gt;</span> <span class="n">cookies</span> <span class="o">=</span> <span class="o">[]</span>

<span class="cm">/*
    public static Map&lt;String, String&gt; headers = ["Content-Type" : "application/json"]
    public static Map&lt;String, Object&gt; params = ["nickname" : "hello"]
*/</span>

    <span class="nd">@BeforeProcess</span> <span class="c1">// 프로세스가 호출되기 전 처리할 동작 정의</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeProcess</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTTPRequestControl</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="mi">300000</span><span class="o">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GTest</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"{ip 주소}"</span><span class="o">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTTPRequest</span><span class="o">()</span>

        <span class="c1">// Set header data</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before process."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@BeforeThread</span> <span class="c1">// 각 쓰레드가 실행되기 전 처리할 동작 정의</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeThread</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">test</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"test"</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">statistics</span><span class="o">.</span><span class="na">delayReports</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before thread."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Before</span> <span class="c1">//  @Test 가 수행되기 전 처리할 동작 정의</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">CookieManager</span><span class="o">.</span><span class="na">addCookies</span><span class="o">(</span><span class="n">cookies</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before. init headers and cookies"</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Test</span> <span class="c1">// 테스트할 동작 정의  </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"https://{ip주소}:8080/{test할 url}"</span><span class="o">,</span> <span class="n">params</span><span class="o">)</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /><br /><br /></p><p>위를 통해 아래와 같이 코드를 적용한 후 실행시켰다. 수정한 부분은 ⭐로 체크했다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">groovy.json.JsonOutput</span>

<span class="nd">@RunWith</span><span class="o">(</span><span class="nc">GrinderRunner</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestRunner</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">GTest</span> <span class="n">test</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HTTPRequest</span> <span class="n">request</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Cookie</span><span class="o">&gt;</span> <span class="n">cookies</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">user</span> <span class="o">=</span> <span class="s">"{\"nickname\": \"nickname\", \"password\": \"password\"}"</span> <span class="c1">// ⭐</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">nickname</span> <span class="o">=</span> <span class="s">"{\"nickname\": \"nickname\"}"</span> <span class="c1">// ⭐</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">token</span> <span class="c1">// ⭐</span>

    <span class="nd">@BeforeProcess</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeProcess</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTTPRequestControl</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="mi">300000</span><span class="o">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GTest</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"{ip 주소}"</span><span class="o">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTTPRequest</span><span class="o">()</span>

        <span class="c1">// Set header data</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json; charset=utf-8"</span><span class="o">)</span> <span class="c1">// ⭐ </span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before process."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@BeforeThread</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeThread</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">test</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"test"</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">statistics</span><span class="o">.</span><span class="na">delayReports</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before thread."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">CookieManager</span><span class="o">.</span><span class="na">addCookies</span><span class="o">(</span><span class="n">cookies</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before. init headers and cookies"</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ⭐</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"https://{ip 주소}:8080/sign-in"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getBytes</span><span class="o">())</span>
        <span class="n">def</span> <span class="n">loginInfo</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">()</span>
        <span class="nc">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">loginInfo</span><span class="o">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"token"</span><span class="o">)</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">token</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"token : {}"</span><span class="o">,</span> <span class="n">token</span><span class="o">)</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ⭐</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"https://{ip 주소}:8080/room"</span><span class="o">,</span> <span class="n">nickname</span><span class="o">.</span><span class="na">getBytes</span><span class="o">())</span>
      
        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/9f20dec4-5d85-4c36-9489-91bd15f1aa20" alt="image" data-proofer-ignore></p><p>정상적으로 로그인 동작 후 해당 token을 header에 담아서 로그인 후의 api도 동작하는 것을 확인할 수 있다.</p><p><br /></p><p>서버 log에서도 해당 header의 token 검증을 완료한 것을 확인할 수 있다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/37b594df-6300-483d-879c-1cc2a73741ee" alt="image" width="50%" data-proofer-ignore></p><p><br /><br /><br /></p><h3 id="로그인-한번만-진행-후-api-test"><span class="mr-2">로그인 한번만 진행 후 api test</span><a href="#로그인-한번만-진행-후-api-test" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>위에서 작성한 코드대로 하면 로그인 한번 후 test를 한 다음 다시 로그인을 하게 된다.</p><p>그래서 로그인을 한번만 진행한 후에 test를 진행하기 위해 수정했다.</p><p>동일한 아이디로 로그인한 후 특정 API를 테스트하기 때문에 <code class="language-plaintext highlighter-rouge">@BeforeProcess</code>에 작성했다.</p><p><br /></p><p><code class="language-plaintext highlighter-rouge">@BeforeProcess</code>는 모든 쓰레드가 공유하는 공통된 상태를 설정하는 데 유용하고,</p><p><code class="language-plaintext highlighter-rouge">@BeforeThread</code>는 각 쓰레드가 독립된 상태를 설정하는 데 유용하다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">grinder</span><span class="o">.</span><span class="na">script</span><span class="o">.</span><span class="na">Grinder</span><span class="o">.</span><span class="na">grinder</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">Assert</span><span class="o">.*</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">Matchers</span><span class="o">.*</span>
<span class="kn">import</span> <span class="nn">net.grinder.script.GTest</span>
<span class="kn">import</span> <span class="nn">net.grinder.script.Grinder</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.GrinderRunner</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.annotation.BeforeProcess</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.annotation.BeforeThread</span>
<span class="c1">// import static net.grinder.util.GrinderUtils.* // You can use this if you're using nGrinder after 3.2.3</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span>
<span class="kn">import</span> <span class="nn">org.junit.BeforeClass</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span>
<span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span>

<span class="c1">// import 추가</span>
<span class="kn">import</span> <span class="nn">groovy.json.JsonOutput</span>
<span class="kn">import</span> <span class="nn">groovy.json.JsonSlurper</span>
  
<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPRequest</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPRequestControl</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPResponse</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.cookie.Cookie</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.cookie.CookieManager</span>

<span class="cm">/**
* A simple example using the HTTP plugin that shows the retrieval of a single page via HTTP.
*
* This script is automatically generated by ngrinder.
*
* @author admin
*/</span>
<span class="nd">@RunWith</span><span class="o">(</span><span class="nc">GrinderRunner</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestRunner</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">GTest</span> <span class="n">test</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HTTPRequest</span> <span class="n">request</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Cookie</span><span class="o">&gt;</span> <span class="n">cookies</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">token</span>
    
    <span class="nd">@BeforeProcess</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeProcess</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTTPRequestControl</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="mi">300000</span><span class="o">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GTest</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"{ip 주소}"</span><span class="o">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTTPRequest</span><span class="o">()</span>

        <span class="c1">// Set header data</span>
        <span class="c1">//headers.put("Content-Type", "application/json; charset=utf-8");</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before process."</span><span class="o">)</span>


   
        <span class="c1">// login</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"https://{ip 주소}:8080/sign-in"</span><span class="o">,</span> <span class="o">[</span><span class="nl">nickname:</span> <span class="s">"nickname"</span><span class="o">,</span> <span class="nl">password:</span> <span class="s">"password"</span><span class="o">])</span> 
      
        <span class="n">def</span> <span class="n">responseBody</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">()</span>
        <span class="n">def</span> <span class="n">jsonResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JsonSlurper</span><span class="o">().</span><span class="na">parseText</span><span class="o">(</span><span class="n">responseBody</span><span class="o">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">jsonResponse</span><span class="o">.</span><span class="na">token</span>

        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">token</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"token : {}"</span><span class="o">,</span> <span class="n">token</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@BeforeThread</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeThread</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">test</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"test"</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">statistics</span><span class="o">.</span><span class="na">delayReports</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before thread."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">CookieManager</span><span class="o">.</span><span class="na">addCookies</span><span class="o">(</span><span class="n">cookies</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before. init headers and cookies"</span><span class="o">)</span>
   
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// login 후 </span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"https://{ip 주소}:8080/room"</span><span class="o">,</span> <span class="o">[</span><span class="nl">nickname:</span> <span class="s">"nickname"</span><span class="o">])</span>
      
        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /><br /></p><p>script를 작성하고 performance test를 진행했다.</p><p><br /></p><p>해당 <code class="language-plaintext highlighter-rouge">/room</code>이 동작하는 방법에 대해서 설명하자면 채팅방 버튼을 누르면 실행이 된다.</p><p>채팅 repository에서 user가 있는지 확인을 하고 없다면 채팅방을 생성한다.</p><p>만약 user가 있다면 해당 roomId를 db에서 가져온 다음 가장 마지막에 작성된 글을 가져온다.</p><p>마지막 글이 null일 경우(채팅방 개설만 하고 채팅을 하지 않은 경우) 임의로 지정한 글을 넘겨주고</p><p>만약 마지막 글이 있을 경우 해당 글을 가져오는데 Map을 활용하여</p><p>roomId에 해당하는 Map이 있을 경우 Map에 있는 값을 가져오고 아닐 경우 file에서 마지막 글을 조회한다.</p><p><br /><br /></p><p>여기서 redis로 cache를 적용했는데 차이가 있는지 비교해봤다.</p><p>&lt; Redis Cache 적용 ⭕ &gt;</p><div class="table-wrapper"><table><thead><tr><th>Total Vusers<th>500<tbody><tr><td>Agent<td>1<tr><td>Processes Threads<td>10 / 50<tr><td>Sample Ignore<td>0<tr><td>TPS<td>139.1<tr><td>Peak TPS<td>342<tr><td>Mean Test Time<td>3,586.78 ms<tr><td>Executed Tests<td>247,650<tr><td>Successful Tests<td>247,648<tr><td>Errors<td>2</table></div><p><br /><br /></p><p>&lt; Redis Cache 적용 ❌ &gt;</p><div class="table-wrapper"><table><thead><tr><th>Total Vusers<th>500<tbody><tr><td>Agent<td>1<tr><td>Processes Threads<td>10 / 50<tr><td>Sample Ignore<td>0<tr><td>TPS<td>111.5<tr><td>Peak TPS<td>344<tr><td>Mean Test Time<td>4,476.48 ms<tr><td>Executed Tests<td>198,007<tr><td>Successful Tests<td>197,864<tr><td>Errors<td>143</table></div><p><br /><br /></p><ul><li><p>TPS (초당 트랜잭션) 비교</p><p>Redis를 사용한 경우: 139.1 <br /> Redis를 사용하지 않은 경우: 111.5 <br /> Redis를 사용한 경우 TPS가 약 24.9% 더 높다.</p><li><p>Mean Test Time (평균 테스트 시간) 비교</p><p>Redis를 사용한 경우: 3,586.78 ms <br /> Redis를 사용하지 않은 경우: 4,476.48 ms <br /> Redis를 사용한 경우 평균 테스트 시간이 약 20.0% 감소했다.</p><li><p>에러 수 비교</p><p>Redis를 사용한 경우: 2 <br /> Redis를 사용하지 않은 경우: 143 <br /> Redis를 사용한 경우에는 에러가 거의 발생하지 않았다.</p></ul><p><br /><br /></p><p>따라서 Redis를 사용하는 것이 성능 및 안정성 면에서 더 효율적임을 알 수 있다.</p><p>특히 평균 테스트 시간의 감소로 인해 사용자는 빠른 응답 속도를 경험할 수 있으며,</p><p>에러 수의 감소로 시스템 안정성이 향상된다.</p><p><br /><br /><br /><br /></p><hr /><h3 id="게시글-curd-script"><span class="mr-2">게시글 curd script</span><a href="#게시글-curd-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="formdata-작성post"><span class="mr-2">formData 작성(post)</span><a href="#formdata-작성post" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>방법 1.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">;</span>

    <span class="nd">@BeforeProcess</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeProcess</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry"</span><span class="o">,</span> <span class="o">[</span><span class="nl">title:</span> <span class="s">"title"</span><span class="o">,</span> <span class="nl">main:</span> <span class="s">"main"</span><span class="o">])</span>

        <span class="c1">// 참고. id값만 저장하기</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">contentBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">contentBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="n">def</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">[</span><span class="s">"idx"</span><span class="o">]</span>
    <span class="o">}</span>
</pre></table></code></div></div><p><br /><br /></p><p>방법 2.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">HTTPClient.NVPair</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span> <span class="c1">// token 저장 </span>
              
        <span class="nc">NVPair</span> <span class="n">param1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NVPair</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="s">"title"</span><span class="o">);</span>
        <span class="nc">NVPair</span> <span class="n">param2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NVPair</span><span class="o">(</span><span class="s">"main"</span><span class="o">,</span> <span class="s">"main"</span><span class="o">);</span>   
        <span class="nc">NVPair</span><span class="o">[]</span> <span class="n">params</span> <span class="o">=</span> <span class="o">[</span><span class="n">param1</span><span class="o">,</span> <span class="n">param2</span><span class="o">]</span>
      
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry"</span><span class="o">,</span> <span class="n">params</span><span class="o">)</span>
    <span class="o">}</span>

</pre></table></code></div></div><p><br /><br /></p><h4 id="최종-전체-코드"><span class="mr-2">최종 전체 코드</span><a href="#최종-전체-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">grinder</span><span class="o">.</span><span class="na">script</span><span class="o">.</span><span class="na">Grinder</span><span class="o">.</span><span class="na">grinder</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">Assert</span><span class="o">.*</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">Matchers</span><span class="o">.*</span>
<span class="kn">import</span> <span class="nn">net.grinder.script.GTest</span>
<span class="kn">import</span> <span class="nn">net.grinder.script.Grinder</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.GrinderRunner</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.annotation.BeforeProcess</span>
<span class="kn">import</span> <span class="nn">net.grinder.scriptengine.groovy.junit.annotation.BeforeThread</span>
<span class="c1">// import static net.grinder.util.GrinderUtils.* // You can use this if you're using nGrinder after 3.2.3</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span>
<span class="kn">import</span> <span class="nn">org.junit.BeforeClass</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span>
<span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span>

<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPRequest</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPRequestControl</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.HTTPResponse</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.cookie.Cookie</span>
<span class="kn">import</span> <span class="nn">org.ngrinder.http.cookie.CookieManager</span>

<span class="kn">import</span> <span class="nn">groovy.json.JsonOutput</span>
<span class="kn">import</span> <span class="nn">groovy.json.JsonSlurper</span>
<span class="kn">import</span> <span class="nn">org.json.JSONObject</span><span class="o">;</span>

<span class="cm">/**
* A simple example using the HTTP plugin that shows the retrieval of a single page via HTTP.
*
* This script is automatically generated by ngrinder.
*
* @author admin
*/</span>
<span class="nd">@RunWith</span><span class="o">(</span><span class="nc">GrinderRunner</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">TestRunner</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">GTest</span> <span class="n">test</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HTTPRequest</span> <span class="n">request</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="o">[:]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Cookie</span><span class="o">&gt;</span> <span class="n">cookies</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">token</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Long</span> <span class="n">idx</span>


    <span class="nd">@BeforeProcess</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeProcess</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTTPRequestControl</span><span class="o">.</span><span class="na">setConnectionTimeout</span><span class="o">(</span><span class="mi">300000</span><span class="o">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GTest</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"{ip 주소}"</span><span class="o">)</span>
        <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTTPRequest</span><span class="o">()</span>
      
        <span class="c1">// login</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/sign-in"</span><span class="o">,</span> <span class="o">[</span><span class="nl">nickname:</span> <span class="s">"nick.123"</span><span class="o">,</span> <span class="nl">password:</span> <span class="s">"nick.123"</span><span class="o">])</span> 
      
        <span class="n">def</span> <span class="n">responseBody</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">()</span>
        <span class="n">def</span> <span class="n">jsonResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JsonSlurper</span><span class="o">().</span><span class="na">parseText</span><span class="o">(</span><span class="n">responseBody</span><span class="o">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">jsonResponse</span><span class="o">.</span><span class="na">token</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">token</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@BeforeThread</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeThread</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">test</span><span class="o">.</span><span class="na">record</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"test"</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">statistics</span><span class="o">.</span><span class="na">delayReports</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before thread."</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">CookieManager</span><span class="o">.</span><span class="na">addCookies</span><span class="o">(</span><span class="n">cookies</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"before. init headers and cookies"</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// 게시글 저장</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="o">)</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">POST</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry"</span><span class="o">,</span> <span class="o">[</span><span class="nl">title:</span> <span class="s">"nick.123"</span><span class="o">,</span> <span class="nl">main:</span> <span class="s">"nick.123"</span><span class="o">])</span>
      
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">contentBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">contentBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="n">def</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"response : {} "</span> <span class="o">,</span> <span class="n">jsonObject</span><span class="o">)</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">[</span><span class="s">"idx"</span><span class="o">]</span>
      
        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
   
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// 게시글 수정 </span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>

        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">PUT</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry/"</span><span class="o">+</span> <span class="n">idx</span><span class="o">,</span> <span class="o">[</span><span class="n">title</span> <span class="o">:</span> <span class="s">"title1"</span><span class="o">,</span> <span class="n">main</span> <span class="o">:</span> <span class="s">"main1"</span><span class="o">]</span>  <span class="o">)</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">contentBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">()</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">contentBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="n">def</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"response : {} "</span> <span class="o">,</span> <span class="n">jsonObject</span><span class="o">)</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"게시글 조회"</span><span class="o">)</span>  
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">GET</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry?idx="</span><span class="o">+</span><span class="n">idx</span><span class="o">)</span>

        <span class="kt">byte</span><span class="o">[]</span> <span class="n">contentBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getBodyText</span><span class="o">()</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">contentBytes</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="n">def</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"response : {} "</span> <span class="o">,</span> <span class="n">jsonObject</span><span class="o">)</span> 
      
        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
   
   
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test4</span><span class="o">()</span> <span class="o">{</span>  
        <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"게시글 삭제"</span><span class="o">)</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">)</span>
        <span class="nc">HTTPResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">DELETE</span><span class="o">(</span><span class="s">"http://{ip 주소}:8080/registry/"</span><span class="o">+</span><span class="n">idx</span><span class="o">)</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span> <span class="o">==</span> <span class="mi">302</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">grinder</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Warning. The response may not be correct. The response code was {}."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">)</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /><br /><br /><br /></p><p>REFERENCE</p><ul><li><a href="https://velog.io/@poepoe117/nGrinder%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-Spring-Boot-%EB%B6%80%ED%95%98-%ED%85%8C%EC%8A%A4%ED%8A%B8">nGrinder을 이용한 Spring Boot 부하 테스트</a><li><a href="https://0soo.tistory.com/223">nGridner 소개와 설치 방법, 간단 테스트</a><li><a href="https://leezzangmin.tistory.com/42">nGrinder + Springboot 부하 테스트 튜토리얼</a><li><a href="https://wecandev.tistory.com/26">[nGrinder ] Docker를 이용한 nGrinder 설치하기</a><li><a href="https://peachytree.tistory.com/31">[ETC] 성능 테스트를 위한 nGrinder 설치 및 사용해보기 (Docker)</a><li><a href="https://beaniejoy.tistory.com/52">docker를 이용한 Ngrinder 성능 테스트 환경 세팅</a><li><a href="https://jane096.github.io/project/ngrinder-performance-test/">nGrinder를 이용한 api 성능테스트 후기</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/project/'>Project</a>, <a href='/categories/%EC%84%B1%EB%8A%A5%ED%85%8C%EC%8A%A4%ED%8A%B8/'>성능테스트</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/monitoring/" class="post-tag no-text-decoration" >Monitoring</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Ngrinder+-+Dal+Blog&url=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FnGrinder%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Ngrinder+-+Dal+Blog&u=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FnGrinder%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FnGrinder%2F&text=Ngrinder+-+Dal+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="haedal-uni/comments" issue-term="title" label="comments" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%ED%86%B5%ED%95%A9-%ED%8C%8C%EC%9D%BC-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0/">통합 파일 작성하기</a><li><a href="/posts/Excel_%EC%9E%90%EB%8F%99%ED%99%94/">Excel_자동화</a><li><a href="/posts/%EB%8B%A8%EC%B6%95%ED%82%A4/">단축키</a><li><a href="/posts/%EA%B4%91%EA%B3%A0-%EB%8D%B0%EC%9D%B4%ED%84%B0/">광고 데이터</a><li><a href="/posts/Google-Analytics/">Google analytics</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/chat/">Chat</a> <a class="post-tag" href="/tags/log/">log</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/websocket/">WebSocket</a> <a class="post-tag" href="/tags/data-structure/">Data-Structure</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Apache-Jmeter/"><div class="card-body"> <em class="small" data-ts="1711292400" data-df="ll" > Mar 25, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Apache jmeter</h3><div class="text-muted small"><p> Apache Jmeter Download Release 클릭 후 나는 apache-jmeter-5.6.3.zip 다운받았다. 파일 압축을 해제 한 후 bin 파일에 들어가서 ApacheJMeter.jar 파일을 실행하면 jmeter가 실행된다. window인 나는 jmeter.bat을 실행했다. JMeter plugin link ...</p></div></div></a></div><div class="card"> <a href="/posts/JMeter-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8/"><div class="card-body"> <em class="small" data-ts="1713193200" data-df="ll" > Apr 16, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Jmeter 성능 테스트</h3><div class="text-muted small"><p> JMeter 성능 테스트 Message Broker를 변경하면서 얼마나 성능이 좋아졌는지 비교하기 위해 JMeter를 활용했다. Test 성능 테스트 1 test할 sampler는 위와 같다. 순서대로 진행이 되기 위해서 특정 sampler 안에 timer를 넣었다. View Results Tree를 보니 요청이 순서대로 실행이 되었...</p></div></div></a></div><div class="card"> <a href="/posts/Optional/"><div class="card-body"> <em class="small" data-ts="1670425200" data-df="ll" > Dec 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Optional</h3><div class="text-muted small"><p> Optional Optional을 찾아보게 된 이유 Repository.findById() List&amp;lt;Long&amp;gt; allByIdx = registryRepository.findAllByIdx(); List&amp;lt;Long&amp;gt; temp = new LinkedList&amp;lt;&amp;gt;(); temp.addAll(allByIdx); ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Spring-Security%EC%9D%98-JWT-%ED%86%A0%ED%81%B0-%EA%B4%80%EB%A6%AC%EC%99%80-%EB%B3%B4%EC%95%88-%ED%95%84%ED%84%B0-%EC%B2%98%EB%A6%AC/" class="btn btn-outline-primary" prompt="Older"><p>Spring security의 jwt 토큰 관리와 보안 필터 처리</p></a> <a href="/posts/Apache-Jmeter/" class="btn btn-outline-primary" prompt="Newer"><p>Apache jmeter</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/haedal-uni">haedal-uni</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/chat/">Chat</a> <a class="post-tag" href="/tags/log/">log</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/websocket/">WebSocket</a> <a class="post-tag" href="/tags/data-structure/">Data-Structure</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-K7KC8XYH0P"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-K7KC8XYH0P'); }); </script>
