<!DOCTYPE html><html lang="ko" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cors" /><meta property="og:locale" content="ko" /><meta name="description" content="CORS 기존 브라우저 정책은 서로 다른 도메인으로부터 리소스가 필요한 경우," /><meta property="og:description" content="CORS 기존 브라우저 정책은 서로 다른 도메인으로부터 리소스가 필요한 경우," /><link rel="canonical" href="https://haedal-uni.github.io//posts/CORS/" /><meta property="og:url" content="https://haedal-uni.github.io//posts/CORS/" /><meta property="og:site_name" content="Dal Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-29T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cors" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-17T20:52:25+09:00","datePublished":"2024-02-29T00:00:00+09:00","description":"CORS 기존 브라우저 정책은 서로 다른 도메인으로부터 리소스가 필요한 경우,","headline":"Cors","mainEntityOfPage":{"@type":"WebPage","@id":"https://haedal-uni.github.io//posts/CORS/"},"url":"https://haedal-uni.github.io//posts/CORS/"}</script><title>Cors | Dal Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dal Blog"><meta name="application-name" content="Dal Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/cotes2020/chirpy-images/main/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dal Blog</a></div><div class="site-subtitle font-italic">한 걸음씩</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/haedal-uni" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cors</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Cors</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1709132400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 29, 2024 </em> </span> <span> Updated <em class="" data-ts="1710676345" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 17, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/haedal-uni">haedal-uni</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3857 words"> <em>21 min</em> read</span></div></div></div><div class="post-content"><h1 id="cors">CORS</h1><p>기존 브라우저 정책은 서로 다른 도메인으로부터 리소스가 필요한 경우,</p><p>보안상의 이유로 다른 도메인의 리소스를 가져오는 것이 불가능했다. (SOP : Single-Origin-Policy)</p><p>하지만 어플리케이션을 개선하고 쉽게 개발하기 위해선 다른 도메인에 요청을 보내는 일은 필연적이다.</p><p>이를 해결하고자 등장한 표준 기술이 <strong>CORS</strong>이다.</p><p><br /></p><p>CORS란 Cross Origin Resource Sharing의 약자로 도메인이 다른 자원에 리소스를 요청할 때 접근 권한을 부여하는 메커니즘이다.</p><p><br /><br /><br /><br /></p><h2 id="url-구조"><span class="mr-2">URL 구조</span><a href="#url-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><code class="language-plaintext highlighter-rouge">Protocol(Scheme)</code> : http, https<li><code class="language-plaintext highlighter-rouge">Host</code> : 사이트 도메인<li><code class="language-plaintext highlighter-rouge">Port</code> : 포트 번호<li><code class="language-plaintext highlighter-rouge">Path</code> : 사이트 내부 경로<li><code class="language-plaintext highlighter-rouge">Query string</code> : 요청의 key와 value값<li><code class="language-plaintext highlighter-rouge">Fragment</code> : 해시 태그</ul><p><br /><br /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://localhost:8080/board?page=1
</pre></table></code></div></div><p>Protocol : <code class="language-plaintext highlighter-rouge">https</code></p><p>Host : <code class="language-plaintext highlighter-rouge">localhost</code></p><p>Port : <code class="language-plaintext highlighter-rouge">8080</code></p><p>Path : <code class="language-plaintext highlighter-rouge">board</code></p><p>Query String : <code class="language-plaintext highlighter-rouge">?page=1</code></p><p><br /></p><p>Origin란 URL 구조에서 살펴본 Protocol, Host, Port를 합친 것을 말한다.</p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/46913ad8-8db8-4ce2-ac8c-509f155dd0e2" alt="image" data-proofer-ignore></p><p><br /></p><p>Origin이 다르다는 말은, HTTP, HTTPS 프로토콜이 다르거나, 주소가 다르거나, 포트번호가 다르다는 말이다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/87177616-5dc1-4904-a635-5913e1e3e11a" alt="image" width="50%" data-proofer-ignore></p><p><br /><br /><br /><br /></p><h2 id="same-origin-policysop--동일-출처-정책"><span class="mr-2">Same Origin Policy(SOP) : 동일 출처 정책</span><a href="#same-origin-policysop--동일-출처-정책" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>동일 출처(Same-Origin) 서버에 있는 리소스는 자유로이 가져올수 있지만,</p><p>다른 출처(Cross-Origin) 서버에 있는 이미지나 유튜브 영상 같은 리소스는 상호작용이 불가능하다.</p><p><br /></p><p>동일 출처가 아닌 경우 접근을 차단하는 이유는</p><p>해커가 CSRF(Cross-Site Request Forgery)나 XSS(Cross-Site Scripting) 등의 방법을 이용해서</p><p>우리가 만든 어플리케이션에서 해커가 심어놓은 코드가 실행하여 개인 정보를 가로챌 수 있다.</p><p><br /></p><p>이러한 악의적인 경우를 방지하기 위해 SOP 정책으로 동일하지 않는 다른 출처의 스크립트가 실행되지 않도록</p><p>브라우저에서 사전에 방지하는 것이다.</p><p>→ 출처를 비교하는 로직은 서버에 구현된 스펙이 아닌 브라우저에 구현된 스펙이다.</p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/1d4f4dd8-0f25-4198-85eb-ea13e64afee9" alt="image" data-proofer-ignore></p><p><br /></p><p><br /><br /><br /><br /></p><h2 id="브라우저의-cors-기본-동작"><span class="mr-2">브라우저의 CORS 기본 동작</span><a href="#브라우저의-cors-기본-동작" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>1.</strong> 클라이언트에서 HTTP요청의 헤더에 Origin을 담아 전달(ex. Origin: <code class="language-plaintext highlighter-rouge">http://localhost:8080</code>)</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/f2b2e275-92d8-4cf1-955e-b718f805f665" alt="image" data-proofer-ignore></p><p><br /></p><p><strong>2.</strong> 서버는 응답헤더에 Access-Control-Allow-Origin을 담아 클라이언트로 전달한다.</p><p>(ex.Acess-Control-Allow-Origin: <code class="language-plaintext highlighter-rouge">http://localhost:8080</code>)</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/17b6dccb-9bc5-4ed3-bad0-9b7c252a193e" alt="image" data-proofer-ignore></p><p><br /></p><p><strong>3.</strong> 클라이언트에서 Origin과 서버가 보내준 Access-Control-Allow-Origin을 비교한다.</p><p><br /><br /></p><p>이후 응답을 받은 브라우저는 자신이 보냈던 요청의 Origin과</p><p>서버가 보내준 응답의 Access-Control-Allow-Origin을 비교해본 후 차단할지 말지를 결정한다.</p><p>만약 유효하지 않다면 그 응답을 사용하지 않고 버린다. 👉🏻 CORS 에러</p><p><br /></p><p>결국 CORS 해결책은 서버의 허용이 필요하다.</p><p><br /><br /><br /><br /></p><h1 id="cors-동작-방식">CORS 동작 방식</h1><p>CORS가 동작하는 방식은 3가지가 있다고 한다.</p><p><br /></p><h2 id="1-예비-요청-preflight-request"><span class="mr-2">1. 예비 요청 (Preflight Request)</span><a href="#1-예비-요청-preflight-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>클라이언트에서 요청하려는 URL이 외부 도메인일 경우, 웹브라우저에서 자체적으로 실행된다.</p><p><br /></p><p>브라우저는 요청을 보낼 때 한번에 바로 보내지않고 먼저 예비 요청을 보내 서버와 잘 통신되는지 확인한 후 본 요청을 보낸다.</p><p>예비 요청의 역할은 본 요청을 보내기 전에 브라우저 스스로 안전한 요청인지 미리 확인하는 것이다.</p><p><br /></p><p>이때, 브라우저가 예비요청을 보내는 것을 Preflight라고 부르며</p><p>이 예비요청의 HTTP 메소드를 GET이나 POST가 아닌 OPTIONS라는 요청이 사용된다는 것이 특징이다.</p><p><br /><br /></p><h4 id="js에서-api-요청-예시"><span class="mr-2">js에서 api 요청 예시</span><a href="#js에서-api-요청-예시" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>🔷 js에서 <code class="language-plaintext highlighter-rouge">start()</code>를 통해 resource를 받아오려고 한다.</p><p>🔷 브라우저는 서버로 HTTP OPTIONS를 통해 예비 요청(Preflight)을 먼저 보낸다.</p><p>🔷 서버는 예비 요청에 대한 응답으로 어떤 것을 허용하고 금지하고 있는지에 대한 header 정보를 담아서 브라우저로 보낸다.</p><p>🔷 브라우저는 보낸 요청과 서버가 응답해준 정책을 비교하여 해당 요청이 안전한지 확인하고 본 요청을 보낸다.</p><p>🔷 서버가 본 요청에 대한응답을 하면 최종적으로 응답 데이터를 js로 넘겨준다.</p><p><br /><br /></p><p>실제 api 요청을 보내면 chrome에서 client와 server가 본 요청을 보내기 전에</p><p>예비 요청(preflight) 통신을 하고 있는 것을 볼 수 있다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/d9da8375-974a-4285-9180-d4f9ebbb21f9" alt="image" data-proofer-ignore></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/f09e2374-6ec0-4568-9c02-a54f80bcf8e1" alt="image" data-proofer-ignore></p><p>예비 요청은 GET이나 POST가 아닌 OPTIONS라는 독립적인 요청 메소드로 보내진다.</p><p><br /><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/6afaab6f-6ae4-440e-81be-1dc6cff255e9" alt="image" data-proofer-ignore></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/e36d7a40-0fe3-4466-ba04-9f2f7259f537" alt="image" data-proofer-ignore></p><p>Request header의 <code class="language-plaintext highlighter-rouge">Origin</code>과 Response header의 <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code>의 출처를 비교한다.</p><p>만약 둘이 다르게되면 브라우저는 이 요청이 CORS 정책을 위반했다고 판단하고 에러를 내보낸다.</p><p><br /><br /></p><h4 id="requset-headers-클라이언트-요청-헤더"><span class="mr-2">Requset headers (클라이언트 요청 헤더)</span><a href="#requset-headers-클라이언트-요청-헤더" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p><code class="language-plaintext highlighter-rouge">Origin</code>: 요청을 보내는 페이지의 출처 (도메인)</p><li><p><code class="language-plaintext highlighter-rouge">Access-Content-Request-Method</code>: 실제 요청하려는 메소드</p><li><p><code class="language-plaintext highlighter-rouge">Access-Content-Request-Headers</code>: 실제 요청에 포함되어 있는 헤더 이름</p></ul><p><br /><br /></p><h4 id="response-headers-서버-응답-헤더"><span class="mr-2">Response headers (서버 응답 헤더)</span><a href="#response-headers-서버-응답-헤더" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code>: 요청을 허용하는 출처 <br /> ( <code class="language-plaintext highlighter-rouge">*</code> 와일드 카드이면 모든 곳에서 허용, 특정하려면 <code class="language-plaintext highlighter-rouge">Protocol + Host + Port</code> 입력)</p><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Credentials</code>: 클라이언트 요청이 쿠키를 통해서 자격 증명을 하는 경우에 true <br /> true를 응답받은 클라이언트는 실제 요청 시 서버에서 정의된 규격의 인증값이 담긴 쿠키를 같이 보내야 한다.</p><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Expose-Headers</code>: 클라이언트 요청에 포함되어도 되는 사용자 정의 헤더</p><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Max-Age</code>: 클라이언트에서 Preflight 의 요청 결과를 저장할 기간을 지정한다. <br /> 클라이언트에서 Preflight 요청의 결과를 저장하고 있을 시간이다. <br /> 해당 시간 동안은 Preflight 요청을 다시 하지 않게된다.</p><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Methods</code>: 요청을 허용하는 메서드, 기본값은 GET, POST라고 보면된다. <br /> 이 헤더가 없으면 GET과 POST요청만 가능하다. <br /> 만약 이 헤더가 지정되어 있으면 클라이언는 헤더 값에 해당하는 메서드일 경우에만 실제 요청을 시도한다.</p><li><p><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Headers</code>: 요청을 허용하는 헤더</p></ul><p><br /><br /></p><p>요청을 보내기 전에 예비요청을 보낸다면</p><p>실제 요청에 걸리는 시간이 늘어나게 되어 어플리케이션 성능에 영향을 미치기 때문에</p><p>브라우저 캐시를 이용해 <code class="language-plaintext highlighter-rouge">Access-Control-Max-Age</code>를 활용하면 Preflight 요청을 캐싱시켜 최적화를 시켜줄 수 있다.</p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/1a93d7da-33ae-4f32-9291-88d6eecf4602" alt="image" data-proofer-ignore></p><p>3600초 → 1시간</p><p><br /></p><p>예비 요청 캐싱 기간에 대해서는, 파이어폭스 브라우저는 86400초(24시간) 까지 가능하지만</p><p>크로미움 기반 브라우저는 7200초(2시간)이 최대이다.</p><p><br /><br /></p><h4 id="예비-요청-캐시-동작과정"><span class="mr-2">예비 요청 캐시 동작과정</span><a href="#예비-요청-캐시-동작과정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>🔷 브라우저는 예비(Preflight) 요청을 할 때마다 먼저 Preflight 캐시를 확인하여 해당 요청에 대한 응답이 있는지 확인한다.</p><p>🔷 만일 응답이 캐싱 되어 있지 않다면,  서버에 예비 요청을 보내 인증 절차를 밟는다.</p><p>🔷 만일 서버로 부터 <code class="language-plaintext highlighter-rouge">Access-Control-Max-Age</code> 응답 헤더를 받는다면 그 기간 동안 브라우저 캐시에 결과를 저장한다.</p><p>🔷 다시 요청을 보내고 만일 응답이 캐싱 되어 있다면 예비 요청을 서버로 보내지 않고 대신 캐시된 응답을 사용한다.</p><p><br /><br /><br /><br /></p><h2 id="2-단순-요청-simple-request"><span class="mr-2">2. 단순 요청 (Simple Request)</span><a href="#2-단순-요청-simple-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>예비 요청(Prefilght)을 생략하고 바로 서버에 직행으로 본 요청을 보낸 후</p><p>서버가 이에 대한 응답의 헤더에 <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> 헤더를 보내주면</p><p>브라우저가 CORS정책 위반 여부를 검사하는 방식이다.</p><p><br /></p><p>but, 아래 3가지 경우를 만족 할 때만 가능하다.</p><p><br /></p><p><strong>1.</strong> 요청의 메소드는 GET, HEAD, POST 중 하나여야 한다.</p><p><strong>2.</strong> <code class="language-plaintext highlighter-rouge">Accept</code>, <code class="language-plaintext highlighter-rouge">Accept-Language</code>, <code class="language-plaintext highlighter-rouge">Content-Language</code>, <code class="language-plaintext highlighter-rouge">Content-Type</code>, <code class="language-plaintext highlighter-rouge">DPR</code>, <code class="language-plaintext highlighter-rouge">Downlink</code>, <code class="language-plaintext highlighter-rouge">Save-Data</code>, <code class="language-plaintext highlighter-rouge">Viewport-Width</code>, <code class="language-plaintext highlighter-rouge">Width</code> <br /> 헤더일 경우에만 적용된다.</p><p><strong>3.</strong> Content-Type 헤더가 <code class="language-plaintext highlighter-rouge">application/x-www-form-urlencoded</code>, <code class="language-plaintext highlighter-rouge">multipart/form-data</code>, <code class="language-plaintext highlighter-rouge">text/plain</code>중 하나여야한다. <br /> 아닐 경우 예비 요청으로 동작된다.</p><p><br /><br /></p><p>위 조건을 모두 만족되어 단순 요청이 일어나는 상황은 드물다.</p><p>대부분 HTTP API 요청은 <code class="language-plaintext highlighter-rouge">text/xml</code> 이나 <code class="language-plaintext highlighter-rouge">application/json</code> 으로 통신하기 때문에</p><p>3번째 Content-Type이 위반되기 때문이다.</p><p><br /></p><p>따라서 대부분의 API 요청은 예비 요청(preflight)으로 이루어진다 라고 이해하면 된다.</p><p><br /><br /><br /><br /></p><h2 id="3-인증된-요청-credentialed-request"><span class="mr-2">3. 인증된 요청 (Credentialed Request)</span><a href="#3-인증된-요청-credentialed-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>인증된 요청은 클라이언트에서 서버에게 자격 인증 정보(Credential)를 실어 요청할 때 사용되는 요청이다.</p><p><br /></p><p>여기서 말하는 자격 인증 정보란 세션 ID가 저장되어있는 쿠키(Cookie) 혹은</p><p>Authorization 헤더에 설정하는 토큰 값 등을 일컫는다.</p><p><br /></p><p>즉, 클라이언트에서 일반적인 JSON 데이터 외에도 쿠키 같은 인증 정보를 포함해서</p><p>다른 출처의 서버로 전달할 때 CORS의 세가지 요청 중 하나인 인증된 요청으로 동작된다</p><p><br /><br /><br /></p><h3 id="1-클라이언트에서-인증-정보를-보내도록-설정하기"><span class="mr-2">1. 클라이언트에서 인증 정보를 보내도록 설정하기</span><a href="#1-클라이언트에서-인증-정보를-보내도록-설정하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>기본적으로 브라우저가 제공하는 요청 API 들은 별도의 옵션 없이</p><p>브라우저의 쿠키와 같은 인증과 관련된 데이터를 함부로 요청 데이터에 담지 않도록 되어있다.</p><p><br /></p><ul><li><p>same-origin(기본값) : 같은 출처 간 요청에만 인증 정보를 담을 수 있다.</p><li><p>include : 모든 요청에 인증 정보를 담을 수 있다.</p><li><p>omit : 모든 요청에 인증 정보를 담지 않는다.</p></ul><p><br /></p><p>이때 요청에 인증과 관련된 정보를 담을 수 있게 해주는 옵션이 바로 credentials 옵션이다.</p><p>만일 이러한 별도의 설정을 해주지 않으면 쿠키 등의 인증 정보는 절대로 자동으로 서버에게 전송되지 않는다.</p><p><br /><br /></p><h3 id="2-서버에서-access-control-allow-origin-헤더-설정하기"><span class="mr-2">2. 서버에서 Access-Control-Allow-Origin 헤더 설정하기</span><a href="#2-서버에서-access-control-allow-origin-헤더-설정하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>응답 헤더의 Access-Control-Allow-Credentials 항목을 true로 설정해야 한다.</p><li><p>응답 헤더의 Access-Control-Allow-Origin 의 값에 와일드카드 문자(<code class="language-plaintext highlighter-rouge">*</code>)는 사용할 수 없다.</p><li><p>응답 헤더의 Access-Control-Allow-Methods 의 값에 와일드카드 문자(<code class="language-plaintext highlighter-rouge">*</code>)는 사용할 수 없다.</p><li><p>응답 헤더의 Access-Control-Allow-Headers 의 값에 와일드카드 문자(<code class="language-plaintext highlighter-rouge">*</code>)는 사용할 수 없다.</p></ul><p><br /><br /></p><p>응답의 <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> 헤더가 와일드카드(<code class="language-plaintext highlighter-rouge">*</code>)가 아닌 분명한 Origin으로 설정되어야 하고</p><p><code class="language-plaintext highlighter-rouge">Access-Control-Allow-Credentials</code> 헤더는 <code class="language-plaintext highlighter-rouge">true</code>로 설정되어야 한다.</p><p>그렇지 않으면 브라우저의 CORS 정책에 의해 응답이 거부된다.</p><p>(인증 정보는 민감한 정보이기 때문에 출처를 정확하게 설정해주어야 한다)</p><p><br /><br /><br /><br /></p><p>직접 서버에서 HTTP 헤더 설정을 통해 출처를 허용하게 설정하는 가장 정석적인 해결책이다.</p><p><br /><br /></p><h4 id="crossorigin"><span class="mr-2"><code class="language-plaintext highlighter-rouge">@CrossOrigin</code></span><a href="#crossorigin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>가장 단순한 해결책은 <code class="language-plaintext highlighter-rouge">@CrossOrigin</code> 을 사용하는 것이다.</p><p><code class="language-plaintext highlighter-rouge">@CrossOrigin</code>을 사용하면 다른 도메인의 클라이언트가 나의 서버에 요청 보내는 것을 허용한다.</p><p><br /></p><p>ex) 서버 : <code class="language-plaintext highlighter-rouge">http://localhost:8080</code>, 클라이언트 : <code class="language-plaintext highlighter-rouge">http://localhost:8081</code></p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>
    <span class="nd">@CrossOrigin</span><span class="o">(</span><span class="s">"http://localhost:8081"</span><span class="o">)</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/hello"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">say</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"hello-world"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nd">@RestController</span>
<span class="nd">@CrossOrigin</span><span class="o">(</span><span class="n">origins</span> <span class="o">=</span> <span class="s">"http://localhost:8081"</span><span class="o">,</span> <span class="n">allowedHeaders</span> <span class="o">=</span> <span class="s">"GET"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>
<span class="o">}</span>
</pre></table></code></div></div><p>하지만 위처럼 작성한다면 수 많은 Controller에 일일히 작성해야한다.</p><p><br /><br /><br /><br /></p><h4 id="filter"><span class="mr-2">Filter</span><a href="#filter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>*Filter 는 꼭 javax.servlet 의 Filter를 사용해야 한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">javax.servlet.*</span><span class="o">;</span>
<span class="nd">@Component</span>
<span class="nd">@Order</span><span class="o">(</span><span class="nc">Ordered</span><span class="o">.</span><span class="na">HIGHEST_PRECEDENCE</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CorsFilter</span> <span class="kd">implements</span> <span class="nc">Filter</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">allowedOrigins</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"http://localhost:8080"</span><span class="o">,</span> <span class="s">"http://localhost:8081"</span>
    <span class="o">};</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">FilterConfig</span> <span class="n">filterConfig</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="nc">ServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">ServletResponse</span> <span class="n">res</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">chain</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">ServletException</span> <span class="o">{</span>
        <span class="nc">HttpServletRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpServletRequest</span><span class="o">)</span> <span class="n">req</span><span class="o">;</span>
        <span class="nc">HttpServletResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">)</span> <span class="n">res</span><span class="o">;</span>

        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Origin"</span><span class="o">,</span> <span class="n">allowedOrigins</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Credentials"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Methods"</span><span class="o">,</span> <span class="s">"GET, OPTIONS, PUT, POST, DELETE"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Max-Age"</span><span class="o">,</span> <span class="s">"3600"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Headers"</span><span class="o">,</span>
                <span class="s">"Origin, X-Requested-With, Content-Type, Accept, Authorization"</span><span class="o">);</span>

        <span class="k">if</span><span class="o">(</span><span class="s">"OPTIONS"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()))</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_OK</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
            <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">res</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>

    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /><br /><br /><br /></p><h4 id="configuration"><span class="mr-2">Configuration</span><a href="#configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
            <span class="o">.</span><span class="na">requestMatchers</span><span class="o">(</span><span class="nl">CorsUtils:</span><span class="o">:</span><span class="n">isPreFlightRequest</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
<span class="cm">/*
CORS preflight 요청에 대해 모든 경로에서 접근을 허용
→ CORS preflight 요청은 인증처리를 하지 않겠다

CORS semantic 상으로 CORS prefight에는 Authorization 헤더를 줄 이유가 없으므로
CORS preflight 요청에 대해서는 401 응답(Unauthorized→  인증이 필요함) 을 하면 안된다. 
*/</span>


<span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">CorsConfigurationSource</span> <span class="nf">corsConfigurationSource</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">CorsConfiguration</span> <span class="n">configuration</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CorsConfiguration</span><span class="o">();</span>
    <span class="n">configuration</span><span class="o">.</span><span class="na">setAllowedOriginPatterns</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"https://www.domain.com"</span><span class="o">));</span>
    <span class="n">configuration</span><span class="o">.</span><span class="na">setAllowedHeaders</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Content-Type"</span><span class="o">));</span>
    <span class="n">configuration</span><span class="o">.</span><span class="na">setAllowedMethods</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"GET"</span><span class="o">,</span> <span class="s">"POST"</span><span class="o">,</span> <span class="s">"PUT"</span><span class="o">,</span> <span class="s">"DELETE"</span><span class="o">,</span> <span class="s">"OPTIONS"</span><span class="o">));</span>
    <span class="n">configuration</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="mi">3600L</span><span class="o">);</span> <span class="c1">// 1 HOUR  </span>
    <span class="n">configuration</span><span class="o">.</span><span class="na">setAllowCredentials</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

    <span class="nc">UrlBasedCorsConfigurationSource</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UrlBasedCorsConfigurationSource</span><span class="o">();</span>
    <span class="n">source</span><span class="o">.</span><span class="na">registerCorsConfiguration</span><span class="o">(</span><span class="s">"/**"</span><span class="o">,</span> <span class="n">configuration</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">source</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>CorsConfiguration : CORS 정책을 정의</p><p>UrlBasedCorsConfigurationSource : CORS 구성을 URL 패턴에 기반하여 설정</p><p><code class="language-plaintext highlighter-rouge">source.registerCorsConfiguration("/**", configuration);</code> : 모든 URL에 대해 CORS 구성을 적용</p><p><br /><br /><br /><br /></p><h4 id="setallowedorigins와-setallowedoriginpatterns"><span class="mr-2"><code class="language-plaintext highlighter-rouge">setAllowedOrigins("*")</code>와 <code class="language-plaintext highlighter-rouge">setAllowedOriginPatterns("*")</code></span><a href="#setallowedorigins와-setallowedoriginpatterns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>위에서 설명했듯이</p><p><code class="language-plaintext highlighter-rouge">setAllowedOrigins("*")</code>를 적용하면 <code class="language-plaintext highlighter-rouge">setAllowCredentials(true)</code>는 사용할 수 없고</p><p><code class="language-plaintext highlighter-rouge">setAllowedOriginPatterns("*")</code>를 적용해야 했다. 정확히 말하자면 와일드카드를 사용할 수 없다.</p><p><br /></p><p>더 유연한 Origin 지정이 필요한 경우에는 setAllowedOriginPatterns를 사용하고,(ex.<code class="language-plaintext highlighter-rouge">https://*.domain.com</code>)</p><p>명시적인 Origin을 지정하는 경우에는 setAllowedOrigins를 사용하는데 (ex.<code class="language-plaintext highlighter-rouge">https://domain.com</code>)</p><p>문제는 명시적으로 작성해도 잘 동작하지 않아 setAllowedOriginPatterns를 사용하게 되었다.</p><p><br /></p><p><code class="language-plaintext highlighter-rouge">setAllowCredentials(true)</code>는 CORS(Cross-Origin Resource Sharing) 관련 설정 중 하나로,</p><p>브라우저 간의 요청에서 인증 정보를 포함하도록 허용하는 옵션이다.</p><p><br /><br /></p><h4 id="s3"><span class="mr-2">S3</span><a href="#s3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>S3 CORS(Cross-origin 리소스 공유)</strong></p><p><code class="language-plaintext highlighter-rouge">Amazon S3 &gt; 버킷 &gt; ${버킷 이름} &gt; 권한 탭</code></p><p>제일 하단으로 내리면 CORS(Cross-origin 리소스 공유)가 보인다.</p><p>편집을 누르고 아래를 붙여넣으면 된다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>[
  {
    "AllowedHeaders": [
      "Authorization"
    ],
    "AllowedMethods": [
      "GET",
      "HEAD"
    ],
    "AllowedOrigins": [
      "https://www.domain.com"
    ],
    "ExposeHeaders": [
      "Access-Control-Allow-Origin"
    ]
  }
]
</pre></table></code></div></div><p><br /><br /><br /><br /></p><h2 id="cors-에러-code"><span class="mr-2">CORS 에러 CODE</span><a href="#cors-에러-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://haedal-uni.github.io/posts/%EB%B0%B0%ED%8F%AC%ED%95%98%EB%A9%B4%EC%84%9C-%EC%83%9D%EA%B8%B4-%EC%B1%84%ED%8C%85-%EA%B4%80%EB%A0%A8-%EC%98%A4%EB%A5%98/#5-has-been-blocked-by-cors-policy">이 글</a>에서 cors 에러가 떠서 security를 수정했는데 남은 기능을 test 해보니 전부 CORS 에러가 떴다.</p><p>문제는 모든 api에 <code class="language-plaintext highlighter-rouge">.antMatchers("/ws/**").permitAll()</code>와 같이</p><p><code class="language-plaintext highlighter-rouge">.permitAll()</code>을 해버리면 인증 없이도 접근 가능한 페이지가 많아진다.</p><p>따라서 cors 에러를 해결했다고 볼 수가 없다.</p><p><br /></p><p>글 하단에 있는 REFERENCE들을 참고하여 수정했다.</p><p><br /></p><p><img data-src="https://github.com/haedal-uni/haedal-uni.github.io/assets/74857364/c29ca350-693b-454e-823d-f1f2da2aff44" alt="image" data-proofer-ignore> <br /> <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/cors/CorsConfiguration.html#setAllowedOrigins(java.util.List)">Class CorsConfiguration</a></p><p><code class="language-plaintext highlighter-rouge">addAllowedOrigin()</code>과 <code class="language-plaintext highlighter-rouge">setAllowedOrigins()</code>의 차이는</p><p>addAllowedOrigin은 허용된 origin을 하나씩 추가하는 것이고</p><p>setAllowedOrigins은 list 형태로 여러 개를 한번에 추가할 수 있다.</p><p><br /><br /></p><p><code class="language-plaintext highlighter-rouge">setAllowedOrigins()</code>을 활용해 origin을 추가했다.</p><p><br /><br /><br /><br /></p><p><strong>REFERENCE</strong></p><ul><li>CORS 란<ul><li><a href="https://velog.io/@hoo00nn/CORSCross-Origin-Resource-Sharing-%EB%9E%80">CORS(Cross-Origin-Resource Sharing) 란?</a><li><div class="table-wrapper"><table><tbody><tr><td>[[Web CORS 이슈<td>setAllowOrigins Preflight Request](https://pearlluck.tistory.com/360)</table></div><li><a href="https://velog.io/@gygy/ExpressNode.js-CORS-%EC%9D%B4%EC%8A%88-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0">[CORS] CORS란? CORS 에러 해결하기</a><li><a href="https://tecoble.techcourse.co.kr/post/2020-07-18-cors/">CORS란?</a><li><a href="https://inpa.tistory.com/entry/WEB-%F0%9F%93%9A-CORS-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95-%F0%9F%91%8F">🌐 악명 높은 CORS 개념 &amp; 해결법 - 정리 끝판왕 👏</a><li><a href="https://hanamon.kr/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-http-options-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0%EC%99%80-cors%EB%9E%80/">[네트워크/HTTP] OPTIONS 메소드를 쓰는 이유와 CORS란?</a><li><a href="https://wonit.tistory.com/572">[Spring Boot] CORS 를 해결하는 3가지 방법 (Filter, @CrossOrigin, WebMvcConfigurer)</a><li><a href="https://dev-pengun.tistory.com/entry/Spring-Boot-CORS-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0">[Spring Boot] CORS 설정하기</a><li><a href="https://oddpoet.net/blog/2017/04/27/cors-with-spring-security/">CORS 설정과 Spring Security</a></ul><li>CORS 에러 관련 해결<ul><li><a href="https://hyeminseo.tistory.com/161">[Cors] Cors 에러 삽질 기록</a><li><a href="https://hi0seon.tistory.com/entry/SpringBoot-CORS-%EC%97%90%EB%9F%AC">[SpringBoot] CORS 에러</a><li><a href="https://rhdqors.tistory.com/33">백 &amp; 프론트 협업시 발생하는 CORS에러 해결 방법.</a></ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/project/'>Project</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/network/" class="post-tag no-text-decoration" >Network</a> <a href="/tags/security/" class="post-tag no-text-decoration" >Security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cors+-+Dal+Blog&url=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FCORS%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cors+-+Dal+Blog&u=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FCORS%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhaedal-uni.github.io%2F%2Fposts%2FCORS%2F&text=Cors+-+Dal+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="haedal-uni/comments" issue-term="title" label="comments" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%ED%86%B5%ED%95%A9-%ED%8C%8C%EC%9D%BC-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0/">통합 파일 작성하기</a><li><a href="/posts/Excel_%EC%9E%90%EB%8F%99%ED%99%94/">Excel_자동화</a><li><a href="/posts/%EB%8B%A8%EC%B6%95%ED%82%A4/">단축키</a><li><a href="/posts/%EA%B4%91%EA%B3%A0-%EB%8D%B0%EC%9D%B4%ED%84%B0/">광고 데이터</a><li><a href="/posts/Google-Analytics/">Google analytics</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/chat/">Chat</a> <a class="post-tag" href="/tags/log/">log</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/websocket/">WebSocket</a> <a class="post-tag" href="/tags/data-structure/">Data-Structure</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Proxy/"><div class="card-body"> <em class="small" data-ts="1671807600" data-df="ll" > Dec 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proxy</h3><div class="text-muted small"><p> 프록시란? 프록시(Proxy)란 ‘대리’라는 의미로, 네트워크 기술에서는 프로토콜에 있어서 대리 응답 등에서 친숙한 개념이다. 보안 분야에서는 주로 보안상의 이유로 직접 통신할 수 없는 두 점 사이에서 통신을 할 경우 그 상이에 있어서 중계기로서 대리로 통신을 수행하는 기능을 가리켜 ‘프록시’, 그 중계 기능을 하는 것을 프록시 서버라고 부른다....</p></div></div></a></div><div class="card"> <a href="/posts/AuthenticationPrincipal-null-%EA%B0%92/"><div class="card-body"> <em class="small" data-ts="1708786800" data-df="ll" > Feb 25, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Authenticationprincipal null 값</h3><div class="text-muted small"><p> @AuthenticationPrincipal을 활용한 사용자 정보 주입 @AuthenticationPrincipal은 Spring Security에서 현재 인증된(principal) 사용자의 정보를 주입받을 때 사용하는 어노테이션이다. 이를 통해 컨트롤러나 서비스에서 현재 사용자의 정보에 쉽게 접근할 수 있다. 문제 User가 UserDetai...</p></div></div></a></div><div class="card"> <a href="/posts/OAuth2/"><div class="card-body"> <em class="small" data-ts="1677942000" data-df="ll" > Mar 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Oauth2</h3><div class="text-muted small"><p> OAuth 애플리케이션 인증을 위한 접근 관한 개방형 표준 프로토콜 인증 : 사용자가 누구인지 확인하는 단계 ex) login 권한 : 사용자가 해당 리소스에 접근할 권리가 있는지를 확인 Open Authorization의 약자로 인터넷 사용자들이 비밀번호를 제공하지 않고, 다른 웹사이트 상의 자신들의 정보에 대해 웹사이트나 애플리...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/AuthenticationPrincipal-null-%EA%B0%92/" class="btn btn-outline-primary" prompt="Older"><p>Authenticationprincipal null 값</p></a> <a href="/posts/Spring-Security-%EC%9D%B8%EC%A6%9D%EA%B3%BC-%EA%B6%8C%ED%95%9C-%EA%B4%80%EB%A6%AC/" class="btn btn-outline-primary" prompt="Newer"><p>Spring security: 인증과 권한 관리</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/haedal-uni">haedal-uni</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/chat/">Chat</a> <a class="post-tag" href="/tags/log/">log</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/websocket/">WebSocket</a> <a class="post-tag" href="/tags/data-structure/">Data-Structure</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-K7KC8XYH0P"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-K7KC8XYH0P'); }); </script>
